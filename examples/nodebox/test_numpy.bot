import opencv, numpy, cairo
from opencv import highgui as hg
im = hg.cvLoadImage('/home/francesco/build/shoebot/assets/hva_studio_3.jpg')
im2 = opencv.cvCreateImage(opencv.cvGetSize(im),8, 4)
opencv.cvCvtColor(im,im2,opencv.CV_BGR2BGRA)
buffer_im = numpy.fromstring(im2.imageData,dtype=numpy.uint32).astype(numpy.uint32)

buffer_im.shape=(im2.width,im2.height)

print buffer_im, buffer_im.shape, buffer_im.strides
buffer_im.flags.writeable=True
imagesurface = cairo.ImageSurface.create_for_data(buffer_im, cairo.FORMAT_RGB24, im2.width, im2.height,im2.width*4)
image(None,0,0,data=imagesurface)